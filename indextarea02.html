<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Proyecto Ac√∫stica UACh - Wavesurfer.js</title>
  <!-- Font Awesome for control icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css">
  <style>
    /* ===== Estilos generales ===== */
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      background-color: #212121;
      color: #f0f0f0;
      display: flex;
      min-height: 100vh;
      flex-direction: column;
    }
    /* ===== Barra lateral ===== */
    .sidebar {
      width: 200px;
      height: 100vh;
      background: #171717;
      color: white;
      padding: 20px;
      position: fixed;
      overflow-y: auto;
    }
    .sidebar-header { text-align: center; margin-bottom: 15px; }
    .sidebar-logo { max-width: 100px; margin-bottom: 10px; }
    .sidebar-title { font-size: 1.2rem; margin-bottom: 5px; color: #f0f0f0; }
    .sidebar-subtitle { font-size: 0.8rem; color: #aaa; margin-bottom: 15px; }
    .sidebar-divider { border-bottom: 1px solid rgba(255,255,255,0.2); margin-bottom: 15px; }
    .nav-btn { display: block; width: 100%; padding: 12px; margin: 8px 0;
      background: #282828; color: #f0f0f0; border: none; border-radius: 4px;
      cursor: pointer; text-align: left; font-size: 15px; transition: all 0.3s;
    }
    .nav-btn:hover { background: #2a2a2a; }
    .nav-btn.active { background: #212121; font-weight: bold; }
    /* ===== Contenido principal ===== */
    .main-content {
      margin-left: 240px;
      padding: 20px 20px 30px 20px;
      width: calc(100% - 240px);
      flex: 1;
    }
    .content-section { display: none; padding: 2rem; margin: 1rem auto 3rem auto;
      max-width: 900px; background: #2a2a2a; border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.3);
    }
    .content-section.active { display: block; }
    h2 { border-bottom: 2px solid #444; padding-bottom: 0.5rem; }
    ul { color: #f0f0f0; }
    footer {
      text-align: center; padding: 0.5rem; color: #aaa;
      font-size: 0.8rem; width: calc(100% - 240px);
      margin-left: 240px; position: fixed; bottom: 0;
    }
    /* ===== Player container ===== */
    .player-container { margin: 20px 0; padding: 15px; background: #333; border-radius: 5px; }
    .audio-info { display: flex; justify-content: space-between; margin-bottom: 10px; }
    .audio-title { font-weight: bold; }
    .audio-duration { color: #aaa; }
    /* ===== Controles personalizados ===== */
    .controls { display: flex; gap: 10px; align-items: center; margin-top: 10px; }
    .controls button { background: #444; border: none; padding: 8px; border-radius: 4px;
      cursor: pointer; color: #f0f0f0; font-size: 14px;
    }
    .controls button:hover { background: #555; }
  </style>
</head>
<body>
  <!-- Sidebar -->
  <div class="sidebar">
    <div class="sidebar-header">
      <img src="imagenes/logo-au.png" alt="Logo UACh" class="sidebar-logo">
      <div class="sidebar-title">Tarea 02 - UACh</div>
      <div class="sidebar-subtitle">ACUS099</div>
    </div>
    <div class="sidebar-divider"></div>
    <button class="nav-btn active" onclick="showSection('inicio')">üè† Inicio</button>
    <button class="nav-btn" onclick="showSection('grabaciones')">üéôÔ∏è Grabaciones Secas</button>
    <button class="nav-btn" onclick="showSection('impulsos')">üîä Respuestas al Impulso</button>
    <button class="nav-btn" onclick="showSection('convolucion')">üîÅ Audios Convolucionados</button>
    <button class="nav-btn" onclick="showSection('galeria')">üì∏ Galer√≠a</button>
  </div>

  <!-- Main Content -->
  <div class="main-content">
    <section id="inicio" class="content-section active">
      <h1>Proyecto de Medici√≥n Ac√∫stica UACh</h1>
      <p>Bienvenido al informe interactivo.</p>
    </section>

    <section id="grabaciones" class="content-section">
      <h2>üéôÔ∏è Grabaciones Secas</h2>
      <div class="player-container" id="voz-seca"></div>
      <div class="player-container" id="instrumento-seco"></div>
    </section>

    <section id="impulsos" class="content-section">
      <h2>üîä Respuestas al Impulso</h2>
      <div class="player-container" id="impulso-camara"></div>
      <div class="player-container" id="impulso-14k"></div>
      <div class="player-container" id="impulso-6k"></div>
    </section>

    <section id="convolucion" class="content-section">
      <h2>üîÅ Audios Convolucionados</h2>
      <div class="player-container" id="voz-camara"></div>
      <div class="player-container" id="voz-14k"></div>
      <div class="player-container" id="voz-6k"></div>
      <div class="player-container" id="instrumento-camara"></div>
      <div class="player-container" id="instrumento-14k"></div>
      <div class="player-container" id="instrumento-6k"></div>
    </section>

    <section id="galeria" class="content-section">
      <h2>üì∏ Galer√≠a Fotogr√°fica</h2>
      <p>Pr√≥ximamente...</p>
    </section>
  </div>

  <footer>
    UACh - Escuela de Ac√∫stica | ISO 3382
  </footer>

  <!-- Scripts -->
  <script src="https://unpkg.com/wavesurfer.js"></script>
  <script>
    // Navegaci√≥n de secciones
    function showSection(id) {
      document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
      document.getElementById(id).classList.add('active');
      document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
      event.target.classList.add('active');
    }

    // Crear reproductor con controles avanzados
    function createAudioPlayer(containerId, src, title) {
      const container = document.getElementById(containerId);
      if (!container) return;
      container.innerHTML = '';

      // Info
      const info = document.createElement('div'); info.className = 'audio-info';
      const t = document.createElement('div'); t.className = 'audio-title'; t.textContent = title;
      const d = document.createElement('div'); d.className = 'audio-duration'; d.textContent = '00:00 / 00:00';
      info.append(t, d); container.append(info);

      // Wavesurfer
      const ws = WaveSurfer.create({
        container: `#${containerId}`,
        waveColor: '#4a4a4a', progressColor: '#2b91af', cursorColor: '#fff',
        barWidth: 2, barRadius: 3, cursorWidth: 1, height: 80, barGap: 2, responsive: true
      });
      ws.load(src);

      // Controls wrapper
      const ctrls = document.createElement('div'); ctrls.className = 'controls';

      // Buttons
      const btns = [
        { icon: 'fa-step-backward', fn: () => ws.skip(-5) },
        { icon: 'fa-play', fn: () => ws.playPause() },
        { icon: 'fa-step-forward', fn: () => ws.skip(5) },
        { icon: 'fa-volume-off', fn: () => ws.toggleMute() },
        { icon: 'fa-stop', fn: () => { ws.stop(); ws.seekTo(0);} }
      ];
      btns.forEach(b => {
        const btn = document.createElement('button');
        btn.innerHTML = `<i class="fa ${b.icon}"></i>`;
        btn.onclick = b.fn;
        ctrls.append(btn);
      });
      container.append(ctrls);

      // Update timer
      ws.on('audioprocess', () => {
        const cur = Math.floor(ws.getCurrentTime());
        const dur = Math.floor(ws.getDuration());
        d.textContent = `${String(Math.floor(cur/60)).padStart(2,'0')}:${String(cur%60).padStart(2,'0')} / ${String(Math.floor(dur/60)).padStart(2,'0')}:${String(dur%60).padStart(2,'0')}`;
      });
    }

    document.addEventListener('DOMContentLoaded', () => {
      // Secas
      createAudioPlayer('voz-seca', 'audios/secos/an_03_poem.wav', 'Voz seca');
      createAudioPlayer('instrumento-seco', 'audios/an_01_bot.wav', 'Instrumento seco');
      // Impulsos
      createAudioPlayer('impulso-camara', 'audios/ri-camara.wav', 'RI C√°mara');
      createAudioPlayer('impulso-14k', 'audios/ri-14k.wav', 'RI Edif. 14K');
      createAudioPlayer('impulso-6k', 'audios/ri-6k.wav', 'RI Pasillos');
      // Convolucionados
      const convs = [
        ['voz-camara','audios/voz-conv-camara.wav','Voz Conv Cam.'],
        ['voz-14k','audios/voz-conv-14k.wav','Voz Conv 14K'],
        ['voz-6k','audios/voz-conv-6k.wav','Voz Conv Pas.'],
        ['instrumento-camara','audios/instrumento-conv-camara.wav','Inst Conv Cam.'],
        ['instrumento-14k','audios/instrumento-conv-14k.wav','Inst Conv 14K'],
        ['instrumento-6k','audios/instrumento-conv-6k.wav','Inst Conv Pas.']
      ];
      convs.forEach(c => createAudioPlayer(c[0], c[1], c[2]));
    });
  </script>
</body>
</html>
